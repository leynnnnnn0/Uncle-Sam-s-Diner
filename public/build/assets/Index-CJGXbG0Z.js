import{a as qe,c as Ge,r as x,j as s,b as ue,t as ye,H as Je}from"./app-CiRA98aR.js";import{M as Ke}from"./module-heading-DZfTyT1p.js";import{A as Qe}from"./app-layout-CN7KtmmX.js";import{T as Ae,a as d,P as We,S as Xe,b as Ye,c as h,d as Ze,e as es}from"./pagination-N8RexGeZ.js";import{D as Fe,a as He,b as ss,c as Le,d as Me,e as Oe}from"./dialog-Bc7Kp8tH.js";import{I as ts}from"./input-CRrgppuD.js";import{L as as}from"./label-B75VGB4k.js";import{T as ls}from"./textarea-BY9V4tc-.js";import{B as n}from"./button-Cwtxneof.js";import{B as V}from"./badge-CHlwJ-f7.js";import{c as fe,d as ge}from"./card-uv4OT8Rw.js";import{E as ze}from"./eye-C5tG6fc4.js";import{C as Te}from"./check-X9npUJny.js";import{U as rs}from"./user-C7nKDIAM.js";import{S as Be}from"./sparkles-BWPt8zvt.js";import{C as is}from"./calendar-Betu5Cga.js";import{A as cs}from"./index-Cxvf8cJg.js";/* empty css            */import"./mainLogo-DUc8BADH.js";import"./index-CzJvs-Dj.js";import"./dropdown-menu-CSxzkttb.js";import"./index-B6GShixz.js";import"./index-CoP3y3hJ.js";import"./index-D6b3eXot.js";import"./qr-code-o7sDSn4x.js";import"./chevron-left-Bw4Zk36T.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],Ie=qe("Undo2",ns);function Os(q){const e=Ge.c(108),{perkClaims:l,filters:m,stats:i}=q,[r,Ve]=x.useState(m.search||""),[a,Ne]=x.useState(null),[be,G]=x.useState(!1),[ve,ke]=x.useState(!1),[j,Ce]=x.useState(""),[o,$e]=x.useState(!1);let J;e[0]!==m.status||e[1]!==r?(J=()=>{const t=setTimeout(()=>{ue.get("/business/perk-claims",{search:r,status:m.status},{preserveState:!0,replace:!0})},300);return()=>clearTimeout(t)},e[0]=m.status,e[1]=r,e[2]=J):J=e[2];let K;e[3]!==r?(K=[r],e[3]=r,e[4]=K):K=e[4],x.useEffect(J,K);let Q;e[5]!==r?(Q=t=>{ue.get("/business/perk-claims",{search:r,status:t},{preserveState:!0,replace:!0})},e[5]=r,e[6]=Q):Q=e[6];const c=Q,W=hs;let X;e[7]===Symbol.for("react.memo_cache_sentinel")?(X=t=>{Ne(t),ke(!0)},e[7]=X):X=e[7];const Ee=X;let Y;e[8]===Symbol.for("react.memo_cache_sentinel")?(Y=t=>{Ne(t),Ce(""),G(!0)},e[8]=Y):Y=e[8];const Pe=Y;let Z;e[9]!==j||e[10]!==a?(Z=()=>{a&&($e(!0),ue.post(`/business/perk-claims/${a.id}/redeem`,{remarks:j},{onSuccess:()=>{ye.success("Perk marked as redeemed successfully!"),G(!1),Ce(""),Ne(null)},onError:xs,onFinish:()=>{$e(!1)}}))},e[9]=j,e[10]=a,e[11]=Z):Z=e[11];const _e=Z,Ue=ds;let ee,se;e[12]===Symbol.for("react.memo_cache_sentinel")?(ee=s.jsx(Je,{title:"Perk Claims"}),se=s.jsx(Ke,{title:"Perk Claims",description:"View and manage customer perk claims."}),e[12]=ee,e[13]=se):(ee=e[12],se=e[13]);const we=`cursor-pointer transition-all ${m.status?"":"ring-2 ring-black"}`;let p;e[14]!==c?(p=()=>c(""),e[14]=c,e[15]=p):p=e[15];let te;e[16]===Symbol.for("react.memo_cache_sentinel")?(te=s.jsx("p",{className:"text-sm text-gray-600",children:"Total Claims"}),e[16]=te):te=e[16];let f;e[17]!==i.total?(f=s.jsxs("div",{children:[te,s.jsx("p",{className:"text-3xl font-bold mt-1",children:i.total})]}),e[17]=i.total,e[18]=f):f=e[18];let ae;e[19]===Symbol.for("react.memo_cache_sentinel")?(ae=s.jsx(cs,{className:"w-10 h-10 text-gray-400"}),e[19]=ae):ae=e[19];let g;e[20]!==f?(g=s.jsx(ge,{className:"",children:s.jsxs("div",{className:"flex items-center justify-between",children:[f,ae]})}),e[20]=f,e[21]=g):g=e[21];let u;e[22]!==p||e[23]!==g||e[24]!==we?(u=s.jsx(fe,{className:we,onClick:p,children:g}),e[22]=p,e[23]=g,e[24]=we,e[25]=u):u=e[25];const Se=`cursor-pointer transition-all ${m.status==="available"?"ring-2 ring-green-500":""}`;let y;e[26]!==c?(y=()=>c("available"),e[26]=c,e[27]=y):y=e[27];let le;e[28]===Symbol.for("react.memo_cache_sentinel")?(le=s.jsx("p",{className:"text-sm text-gray-600",children:"Available"}),e[28]=le):le=e[28];let N;e[29]!==i.available?(N=s.jsxs("div",{children:[le,s.jsx("p",{className:"text-3xl font-bold mt-1 text-green-600",children:i.available})]}),e[29]=i.available,e[30]=N):N=e[30];let re;e[31]===Symbol.for("react.memo_cache_sentinel")?(re=s.jsx(Be,{className:"w-10 h-10 text-green-400"}),e[31]=re):re=e[31];let b;e[32]!==N?(b=s.jsx(ge,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[N,re]})}),e[32]=N,e[33]=b):b=e[33];let v;e[34]!==Se||e[35]!==y||e[36]!==b?(v=s.jsx(fe,{className:Se,onClick:y,children:b}),e[34]=Se,e[35]=y,e[36]=b,e[37]=v):v=e[37];const Re=`cursor-pointer transition-all ${m.status==="redeemed"?"ring-2 ring-gray-500":""}`;let k;e[38]!==c?(k=()=>c("redeemed"),e[38]=c,e[39]=k):k=e[39];let ie;e[40]===Symbol.for("react.memo_cache_sentinel")?(ie=s.jsx("p",{className:"text-sm text-gray-600",children:"Redeemed"}),e[40]=ie):ie=e[40];let C;e[41]!==i.redeemed?(C=s.jsxs("div",{children:[ie,s.jsx("p",{className:"text-3xl font-bold mt-1 text-gray-600",children:i.redeemed})]}),e[41]=i.redeemed,e[42]=C):C=e[42];let ce;e[43]===Symbol.for("react.memo_cache_sentinel")?(ce=s.jsx(Te,{className:"w-10 h-10 text-gray-400"}),e[43]=ce):ce=e[43];let _;e[44]!==C?(_=s.jsx(ge,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[C,ce]})}),e[44]=C,e[45]=_):_=e[45];let w;e[46]!==Re||e[47]!==k||e[48]!==_?(w=s.jsx(fe,{className:Re,onClick:k,children:_}),e[46]=Re,e[47]=k,e[48]=_,e[49]=w):w=e[49];let S;e[50]!==u||e[51]!==v||e[52]!==w?(S=s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-6",children:[u,v,w]}),e[50]=u,e[51]=v,e[52]=w,e[53]=S):S=e[53];let ne;e[54]===Symbol.for("react.memo_cache_sentinel")?(ne=s.jsx(Xe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e[54]=ne):ne=e[54];let de;e[55]===Symbol.for("react.memo_cache_sentinel")?(de=t=>Ve(t.target.value),e[55]=de):de=e[55];let R;e[56]!==r?(R=s.jsxs("div",{className:"mb-4 relative max-w-md",children:[ne,s.jsx(ts,{type:"text",placeholder:"Search by customer, reward, or card...",value:r,onChange:de,className:"pl-10"})]}),e[56]=r,e[57]=R):R=e[57];let me;e[58]===Symbol.for("react.memo_cache_sentinel")?(me=s.jsx(Ye,{children:s.jsxs(Ae,{children:[s.jsx(h,{children:"Customer"}),s.jsx(h,{children:"Reward"}),s.jsx(h,{children:"Loyalty Card"}),s.jsx(h,{children:"Stamps"}),s.jsx(h,{children:"Status"}),s.jsx(h,{children:"Claimed At"}),s.jsx(h,{children:"Actions"})]})}),e[58]=me):me=e[58];let D;e[59]!==l.data?(D=l.data.length>0?l.data.map(t=>s.jsxs(Ae,{children:[s.jsx(d,{children:s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",children:t.customer.username}),s.jsx("div",{className:"text-xs text-gray-500",children:t.customer.email})]})}),s.jsx(d,{children:s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",children:t.perk.reward}),t.perk.details&&s.jsx("div",{className:"text-xs text-gray-500",children:t.perk.details})]})}),s.jsx(d,{children:s.jsxs("div",{className:"flex items-center gap-2",children:[t.loyalty_card.logo&&s.jsx("img",{src:`/${t.loyalty_card.logo}`,alt:t.loyalty_card.name,className:"w-8 h-8 rounded-full object-cover"}),s.jsx("span",{children:t.loyalty_card.name})]})}),s.jsx(d,{children:t.stamps_at_claim}),s.jsx(d,{children:t.is_redeemed?s.jsx(V,{className:"bg-gray-500 hover:bg-gray-600",children:"Redeemed"}):s.jsx(V,{className:"bg-green-500 hover:bg-green-600",children:"Available"})}),s.jsx(d,{className:"text-sm",children:W(t.created_at)}),s.jsx(d,{children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(n,{size:"sm",variant:"outline",onClick:()=>Ee(t),children:s.jsx(ze,{className:"w-4 h-4"})}),t.is_redeemed?s.jsxs(n,{size:"sm",variant:"outline",onClick:()=>Ue(t),children:[s.jsx(Ie,{className:"w-4 h-4 mr-1"}),"Undo"]}):s.jsxs(n,{size:"sm",onClick:()=>Pe(t),className:"bg-green-600 hover:bg-green-700",children:[s.jsx(Te,{className:"w-4 h-4 mr-1"}),"Redeem"]})]})})]},t.id)):s.jsx(Ae,{children:s.jsx(d,{colSpan:7,className:"text-center py-8",children:"No perk claims found."})}),e[59]=l.data,e[60]=D):D=e[60];let A;e[61]!==D?(A=s.jsx("div",{className:"hidden md:block border rounded-lg overflow-hidden",children:s.jsxs(Ze,{children:[me,s.jsx(es,{children:D})]})}),e[61]=D,e[62]=A):A=e[62];let T;e[63]!==l.data?(T=l.data.length>0?l.data.map(t=>s.jsx(fe,{children:s.jsxs(ge,{className:"p-4 space-y-3",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[t.loyalty_card.logo&&s.jsx("img",{src:`/${t.loyalty_card.logo}`,alt:t.loyalty_card.name,className:"w-12 h-12 rounded-full object-cover"}),s.jsxs("div",{children:[s.jsx("div",{className:"font-semibold",children:t.perk.reward}),s.jsx("div",{className:"text-sm text-gray-600",children:t.loyalty_card.name})]})]}),t.is_redeemed?s.jsx(V,{className:"bg-gray-500",children:"Redeemed"}):s.jsx(V,{className:"bg-green-500",children:"Available"})]}),s.jsxs("div",{className:"text-sm space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[s.jsx(rs,{className:"w-4 h-4"}),s.jsx("span",{children:t.customer.username})]}),s.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[s.jsx(Be,{className:"w-4 h-4"}),s.jsxs("span",{children:[t.stamps_at_claim," stamps"]})]}),s.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[s.jsx(is,{className:"w-4 h-4"}),s.jsx("span",{children:W(t.created_at)})]})]}),s.jsxs("div",{className:"flex gap-2 pt-2",children:[s.jsxs(n,{size:"sm",variant:"outline",onClick:()=>Ee(t),className:"flex-1",children:[s.jsx(ze,{className:"w-4 h-4 mr-1"}),"Details"]}),t.is_redeemed?s.jsxs(n,{size:"sm",variant:"outline",onClick:()=>Ue(t),className:"flex-1",children:[s.jsx(Ie,{className:"w-4 h-4 mr-1"}),"Undo"]}):s.jsxs(n,{size:"sm",onClick:()=>Pe(t),className:"flex-1 bg-green-600 hover:bg-green-700",children:[s.jsx(Te,{className:"w-4 h-4 mr-1"}),"Redeem"]})]})]})},t.id)):s.jsx("div",{className:"border rounded-lg p-8 text-center text-gray-500",children:"No perk claims found."}),e[63]=l.data,e[64]=T):T=e[64];let $;e[65]!==T?($=s.jsx("div",{className:"md:hidden space-y-4",children:T}),e[65]=T,e[66]=$):$=e[66];let E;e[67]!==l?(E=l.last_page>1&&s.jsx(We,{data:l}),e[67]=l,e[68]=E):E=e[68];let P;e[69]!==R||e[70]!==A||e[71]!==$||e[72]!==E?(P=s.jsxs("div",{className:"mt-6",children:[R,A,$,E]}),e[69]=R,e[70]=A,e[71]=$,e[72]=E,e[73]=P):P=e[73];let oe;e[74]===Symbol.for("react.memo_cache_sentinel")?(oe=s.jsxs(Fe,{children:[s.jsx(He,{children:"Mark as Redeemed"}),s.jsx(ss,{children:"Confirm that this perk has been redeemed by the customer."})]}),e[74]=oe):oe=e[74];let U;e[75]!==j||e[76]!==a?(U=a&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Customer:"}),s.jsx("span",{className:"font-medium",children:a.customer.username})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Reward:"}),s.jsx("span",{className:"font-medium",children:a.perk.reward})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Card:"}),s.jsx("span",{className:"font-medium",children:a.loyalty_card.name})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(as,{htmlFor:"remarks",children:"Remarks (Optional)"}),s.jsx(ls,{id:"remarks",placeholder:"Add any notes about this redemption...",value:j,onChange:t=>Ce(t.target.value),rows:3})]})]}),e[75]=j,e[76]=a,e[77]=U):U=e[77];let xe;e[78]===Symbol.for("react.memo_cache_sentinel")?(xe=()=>G(!1),e[78]=xe):xe=e[78];let F;e[79]!==o?(F=s.jsx(n,{variant:"outline",onClick:xe,disabled:o,children:"Cancel"}),e[79]=o,e[80]=F):F=e[80];const De=o?"Processing...":"Mark as Redeemed";let H;e[81]!==_e||e[82]!==o||e[83]!==De?(H=s.jsx(n,{onClick:_e,disabled:o,className:"bg-green-600 hover:bg-green-700",children:De}),e[81]=_e,e[82]=o,e[83]=De,e[84]=H):H=e[84];let L;e[85]!==F||e[86]!==H?(L=s.jsxs(Le,{children:[F,H]}),e[85]=F,e[86]=H,e[87]=L):L=e[87];let M;e[88]!==U||e[89]!==L?(M=s.jsxs(Me,{className:"sm:max-w-md",children:[oe,U,L]}),e[88]=U,e[89]=L,e[90]=M):M=e[90];let O;e[91]!==be||e[92]!==M?(O=s.jsx(Oe,{open:be,onOpenChange:G,children:M}),e[91]=be,e[92]=M,e[93]=O):O=e[93];let he;e[94]===Symbol.for("react.memo_cache_sentinel")?(he=s.jsx(Fe,{children:s.jsx(He,{children:"Perk Claim Details"})}),e[94]=he):he=e[94];let z;e[95]!==a?(z=a&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Customer"}),s.jsx("p",{className:"font-semibold",children:a.customer.username}),s.jsx("p",{className:"text-sm text-gray-500",children:a.customer.email})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Status"}),a.is_redeemed?s.jsx(V,{className:"bg-gray-500 mt-1",children:"Redeemed"}):s.jsx(V,{className:"bg-green-500 mt-1",children:"Available"})]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Reward"}),s.jsx("p",{className:"font-semibold",children:a.perk.reward}),a.perk.details&&s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:a.perk.details})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Loyalty Card"}),s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[a.loyalty_card.logo&&s.jsx("img",{src:`/${a.loyalty_card.logo}`,alt:a.loyalty_card.name,className:"w-8 h-8 rounded-full object-cover"}),s.jsx("span",{className:"font-semibold",children:a.loyalty_card.name})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Stamps at Claim"}),s.jsx("p",{className:"font-semibold",children:a.stamps_at_claim})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Claimed At"}),s.jsx("p",{className:"font-semibold text-sm",children:W(a.created_at)})]})]}),a.is_redeemed&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Redeemed At"}),s.jsx("p",{className:"font-semibold text-sm",children:a.redeemed_at?W(a.redeemed_at):"N/A"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Redeemed By"}),s.jsx("p",{className:"font-semibold text-sm",children:a.redeemed_by?.username||"N/A"})]})]}),a.remarks&&s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Remarks"}),s.jsx("p",{className:"text-sm bg-gray-50 p-3 rounded-lg mt-1",children:a.remarks})]})]})]}),e[95]=a,e[96]=z):z=e[96];let je;e[97]===Symbol.for("react.memo_cache_sentinel")?(je=s.jsx(Le,{children:s.jsx(n,{variant:"outline",onClick:()=>ke(!1),children:"Close"})}),e[97]=je):je=e[97];let B;e[98]!==z?(B=s.jsxs(Me,{className:"sm:max-w-lg",children:[he,z,je]}),e[98]=z,e[99]=B):B=e[99];let I;e[100]!==ve||e[101]!==B?(I=s.jsx(Oe,{open:ve,onOpenChange:ke,children:B}),e[100]=ve,e[101]=B,e[102]=I):I=e[102];let pe;return e[103]!==S||e[104]!==P||e[105]!==O||e[106]!==I?(pe=s.jsxs(Qe,{children:[ee,se,S,P,O,I]}),e[103]=S,e[104]=P,e[105]=O,e[106]=I,e[107]=pe):pe=e[107],pe}function ds(q){confirm("Are you sure you want to undo this redemption?")&&ue.post(`/business/perk-claims/${q.id}/undo`,{},{onSuccess:os,onError:ms})}function ms(){ye.error("Failed to undo redemption.")}function os(){ye.success("Redemption undone successfully!")}function xs(){ye.error("Failed to mark perk as redeemed.")}function hs(q){return new Date(q).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}export{Os as default};
